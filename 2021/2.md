

# è§£å†³è·¨åŸŸæ—¶Chromeæµè§ˆå™¨cookieæ— æ³•æºå¸¦

## èƒŒæ™¯

æˆ‘åŸæœ¬å¼€å¼€å¿ƒå¿ƒåœ°å‡çº§äº†Chromeæµè§ˆå™¨ï¼Œç»“æœå‘ç°æœ¬åœ°è·‘çš„é¡¹ç›®ç™»å½•ä¸€ç›´æŠ¥é”™ï¼Œç»è¿‡ä¸€ç•ªèµ„æ–™æŸ¥è¯¢ï¼Œå‘ç°æ˜¯æœ¬åœ°é¡¹ç›®ï¼ˆlocalhostï¼‰è¯·æ±‚æ¥å£æ—¶æ²¡æœ‰å¸¦ä¸Šè®¤è¯ä¿¡æ¯çš„cookieå¯¼è‡´çš„ç™»å½•å¤±è´¥ã€‚

è¿™ä¸ªé—®é¢˜æˆ‘é‡è¿‡å¥½å‡ æ¬¡äº†ï¼Œwindowså’Œmacéƒ½æœ‰ï¼Œç‰¹åœ°æ€»ç»“è§£å†³çš„æ–¹æ³•ã€‚

## Chromeç‰ˆæœ¬çš„cookieç­–ç•¥

| Chromeç‰ˆæœ¬  | cookieç­–ç•¥                                                   |
| ----------- | ------------------------------------------------------------ |
| >= Chrome80 | è·¨åŸŸæ— æ³•æºå¸¦ï¼›å¯è®¾ç½®å®éªŒåŠŸèƒ½é€‰é¡¹æ¥å¼€å¯å…è®¸è·¨åŸŸæºå¸¦           |
| >= Chrome91 | è·¨åŸŸæ— æ³•æºå¸¦ï¼›åˆ é™¤äº†è®¾ç½®é€‰é¡¹çš„å¼€å¯æ–¹å¼ï¼Œä½†å¯é€šè¿‡é…ç½®å‘½ä»¤å‚æ•°å¼€å¯å…è®¸è·¨åŸŸæºå¸¦ |
| >= Chrome94 | è·¨åŸŸæ— æ³•æºå¸¦ï¼›æ²¡æœ‰å¼€å¯åŠæ³•                                   |

## >=Chrome80

**å¯è®¾ç½®å®éªŒåŠŸèƒ½é€‰é¡¹æ¥å¼€å¯å…è®¸è·¨åŸŸæºå¸¦ï¼š**

1. Chromeæµè§ˆå™¨æ‰“å¼€ chrome://flags/ é¡µé¢

2. æœç´¢cookieï¼Œå¹¶è®¾ç½® `SameSite by default cookies`  ã€`Cookies without SameSite must be secure` ä¸¤é¡¹ä¸º `disabled`

   ![](2.assets/1.png)

3. é‡å¯æµè§ˆå™¨

## >=Chrome91

**é€šè¿‡é…ç½®å‘½ä»¤å‚æ•°å¼€å¯å…è®¸è·¨åŸŸæºå¸¦:**

### Windowsé…ç½®

1. å³å‡»Chromeåº”ç”¨å›¾æ ‡æ‰“å¼€å±æ€§é¢æ¿

2. åœ¨ `ç›®æ ‡` å­—æ®µå¢åŠ å‘½ä»¤å‚æ•°ï¼š

   ```sh
   --disable-features=SameSiteByDefaultCookies,CookiesWithoutSameSiteMustBeSecure
   ```

   å®Œæ•´çš„ç›®æ ‡å­—æ®µï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š

   ```sh
   "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --disable-features=SameSiteByDefaultCookies,CookiesWithoutSameSiteMustBeSecure
   ```

   ![](2.assets/2.png)

 3. é‡å¯æµè§ˆå™¨

### macé…ç½®

1. æ‰“å¼€ç»ˆç«¯

2. è¾“å…¥å‘½ä»¤ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼š

```sh
open -n /Applications/Google\ Chrome.app/ --args --disable-features=SameSiteByDefaultCookies,CookiesWithoutSameSiteMustBeSecure
```

> å®é™…æƒ…å†µï¼Œæˆ‘Macçš„Chrome93ç‰ˆæœ¬æ²¡æœ‰ç”Ÿæ•ˆï¼Œå…·ä½“åŸå› ä¸è¯¦ã€‚

## >=Chrome94

ä¸æ”¯æŒä»»ä½•æ–¹å¼è®¾ç½®å¼€å¯å…è®¸è·¨åŸŸæºå¸¦ï¼Œå¯é€šè¿‡è®¾ç½®ä»£ç†è®¾ç½®ä¸ºåŒåŸŸï¼Œæˆ–è€…é€šè¿‡å®‰è£…ä½ç‰ˆæœ¬Chormeæ¥è§£å†³ã€‚

### è®¾ç½®ä»£ç†

å‡è®¾ï¼š

```
æœ¬åœ°å¼€å‘åŸŸåï¼šlocalhost:3000
è¯·æ±‚æ¥å£ï¼šhttp://mydemo.com/api/**
```

ä»¥vue2é¡¹ç›®ä¸ºä¾‹ï¼Œè®¾ç½®ä»£ç†:

```js
devServer: {
    // å¼€ä»£ç†ï¼Œè§£å†³å¼€å‘æ—¶è·¨åŸŸé—®é¢˜
    proxy: {
      '/api': {
        target: 'http://mydemo.com',
        changeOrigin: true
      }
    }
}
```

æœ€åé¡¹ç›®ä¸­ä½¿ç”¨ï¼š

```
æœ¬åœ°å¼€å‘åŸŸåï¼šlocalhost:3000
è¯·æ±‚æ¥å£ï¼šlocalhost:3000/api/**   # è¯·æ±‚localhost:3000/api/** æœ€ç»ˆä¼šä»£ç†åˆ° http://mydemo.com/api/**
```

é¡¹ç›®ä¸­ä½¿ç”¨çš„éƒ½æ˜¯ `localhost:3000`ï¼Œå°±ä¸ä¼šäº§ç”Ÿè·¨åŸŸé—®é¢˜ã€‚

**ä½†æ˜¯ï¼Œå¾ˆå¤šæƒ…å†µä¸ºäº†å®‰å…¨ï¼Œæ¥å£åªä¼šå°†cookieè®¾ç½®åˆ°ç‰¹å®šçš„åŸŸåä¸‹ï¼Œé‚£å°±éœ€è¦åœ¨å¼€å‘æ—¶å¢åŠ å­åŸŸ**ã€‚

### å¢åŠ å­åŸŸ

ä¸Šé¢ä¾‹å­ä¸­ï¼Œå¦‚æœæŸäº›cookieåªèƒ½è®¾ç½®åœ¨ `mydemo.com` åŸŸåä¸‹ï¼Œé‚£ä¹ˆåœ¨ `localhost:3000` æ˜¯æ— æ³•æºå¸¦ `mydemo.com` åŸŸåä¸‹çš„cookieçš„ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦è®¾ç½®å­åŸŸåï¼Œå°† `localhost:3000` æŒ‡å‘ `localhost.mydemo.com:3000` å°±è¡Œäº†ã€‚

#### ä¿®æ”¹hostsæ–‡ä»¶(åŸŸåè§£ææ–‡ä»¶)

```
windowsçš„hostsæ–‡ä»¶ç›®å½•: C:\Windows\System32\drivers\etc\hosts
macçš„hostsæ–‡ä»¶ç›®å½•: /private/etc/hosts ã€è¿›å…¥è®¿è¾¾ï¼ŒShift-Command-G æ‰“å¼€â€œå‰å¾€æ–‡ä»¶å¤¹â€ï¼Œè¾“å…¥/private/etcï¼Œæ‰¾åˆ°hostsæ–‡ä»¶ã€‘
```

æ‰“å¼€hostsæ–‡ä»¶å¹¶æ·»åŠ :

```
127.0.0.1   localhost.mydemo.com # 
```

> `127.0.0.1` ä¸ºæœ¬åœ°ipï¼Œç›¸å½“äº `localhost`, æ­¤å¤„ä½œç”¨æ˜¯å°† `localhost` æŒ‡å‘ `localhost.mydemo.com`ã€‚

æœ€ç»ˆé¡¹ç›®ä¸­ä½¿ç”¨ï¼š

```
æœ¬åœ°å¼€å‘åŸŸåï¼šlocalhost.mydemo.com:3000
è¯·æ±‚æ¥å£ï¼šlocalhost.mydemo.com:3000/api/**
```

## å®‰è£…å¤šç‰ˆæœ¬Chrome

ä¸ç®¡Chromeæ€ä¹ˆå‡çº§ï¼Œå¼€å‘æ—¶æˆ‘å°±å–œæ¬¢ç”¨Chrome79ï¼Œå°±æ˜¯å¿«ä¹ğŸ¶ã€‚

ä¸‹é¢ä»¥Chrome79ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨å·²æœ‰Chromeä¸‹ï¼Œå†å®‰è£…ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–ç‰ˆæœ¬çš„Chromeæµè§ˆå™¨ã€‚

### Windows

`windows` ä¸‹å„ä¸ªç‰ˆæœ¬Chromeçš„ä¸‹è½½åœ°å€ï¼šhttps://www.chromedownloads.net/chrome64win-stable/

1. é€‰æ‹©chrome_win64_stable_79.0.3945.79ç‰ˆæœ¬ä¸‹è½½ï¼ˆæŒ‰éœ€è¦ä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼‰

   ![](2.assets/8-6.png)

2. **ä¸è¦ç›´æ¥å®‰è£…**ï¼Œå…ˆä¸‹è½½å¹¶å®‰è£…7-Zipå‹ç¼©è½¯ä»¶

3. å³å‡».exeæ–‡ä»¶ï¼Œé€‰æ‹©`7-Zip -- æå–åˆ°å½“å‰ä½ç½®`ï¼Œä¼šè§£å‹å‡º `chrome.7z` çš„æ–‡ä»¶ï¼Œå†å¯¹ `chrome.7z` æ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œè§£å‹å‡º   `chrome`  ç›®å½•

   ![](2.assets/8-1.png)

   ![](2.assets/8-2.png)

4. è¿›å…¥ç›®å½• `chrome/Chrome-bin`ï¼Œæ­¤æ—¶ä¼šçœ‹åˆ°chrome.exeæ–‡ä»¶ï¼Œæ­¤æ—¶åŒå‡»æ˜¯ä¸èƒ½ç›´æ¥æ‰“å¼€79ç‰ˆæœ¬æµè§ˆå™¨çš„ï¼›éœ€è¦chrome.exe å³å‡»ï¼Œå‘é€åˆ°æ¡Œé¢å¿«æ·æ–¹å¼

   ![](2.assets/8-3.png)

5. æ‰“å¼€ç”µè„‘æ¡Œé¢ï¼Œä¸ºæ–¹ä¾¿åŒºåˆ†ï¼Œå°†  `chrome.exe ` æ¡Œé¢å¿«æ·æ–¹å¼æ”¹åä¸º `chrome79.exe`ï¼Œå³å‡»é€‰æ‹©å±æ€§ï¼Œåœ¨`ç›®æ ‡` å­—æ®µåæ·»åŠ å‚æ•°ï¼š

      ```sh
       --disable-web-security --user-data-dir=D:\ChromeData\MyChromeDevUserData79
      ```

      `--user-data-dir`:  chrome79.exe åº”ç”¨æ•°æ®å­˜å‚¨ç›®å½•ï¼Œ**å¿…é¡»æœ‰**ï¼Œæ ¹æ®ä¸ªäººæƒ…å†µä¿®æ”¹ã€‚

      `--disable-web-security`: è®¾ç½®è·¨åŸŸï¼Œå¯ä¸åŠ ï¼›

![](2.assets/8-4.png)

6. åŒå‡» `chrome79.exe` æ¡Œé¢å¿«æ·æ–¹å¼ï¼Œå°±èƒ½æ‰“å¼€äº†ã€‚
   

![](2.assets/8-5.png)

### Mac

`mac` ä¸‹å„ä¸ªç‰ˆæœ¬Chromeçš„ä¸‹è½½åœ°å€ï¼šhttps://google-chrome.cn.uptodown.com/mac/versions

1. é€‰æ‹©80.0.3987.53ç‰ˆæœ¬ä¸‹è½½ï¼ˆæŒ‰éœ€è¦ä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼‰

   ![](2.assets/3.jpeg)

2. åŒå‡»dmgæ–‡ä»¶ï¼Œå°†chromeæ‹–åˆ°Applicationæ–‡ä»¶å¤¹ï¼Œé€‰æ‹©ä¿ç•™ä¸¤è€…ï¼Œä¸è¦æ›¿æ¢

   ![](2.assets/4.jpeg)

3. æ‰“å¼€åº”ç”¨ç¨‹åºç›®å½•ï¼Œèƒ½çœ‹åˆ°æœ‰ä¸¤ä¸ªGoogle Chromeï¼Œè€Œ `Google Chrome 2.app`  å°±æ˜¯åˆšå®‰è£…çš„ç¨‹åºï¼Œä¸ºç¡®ä¿å®‰å…¨ï¼Œçœ‹ä¸€ä¸‹ç¨‹åºçš„ç®€ä»‹ã€‚

   ![](2.assets/5.jpeg)

   ![](2.assets/6.jpeg)

   è™½ç„¶ä¸‹è½½æ˜¯80.0.3987.53ç‰ˆæœ¬ï¼Œä½†æ˜¯ç®€ä»‹å†™çš„æ˜¯79ç‰ˆæœ¬ï¼ˆçœŸå®çš„æ˜¯79ç‰ˆæœ¬ï¼Œæœ‰ç‚¹æŒ‚ç¾Šå¤´å–ç‹—è‚‰äº†ï¼‰ã€‚

4. ä¸ºæ–¹ä¾¿åŒºåˆ†ï¼Œå°† `Google Chrome 2.app` é‡å‘½åä¸º `Google Chrome79.app`ã€‚

5. ç›´æ¥åŒå‡»æ˜¯æ— æ³•æ‰“å¼€79ç‰ˆæœ¬Chromeçš„ï¼Œéœ€è¦æ‰“å¼€ç»ˆç«¯ï¼Œé€šè¿‡å‘½ä»¤æ‰“å¼€ï¼š

   ```sh
   open -n /Applications/Google\ Chrome79.app/ --args --disable-web-security --user-data-dir=/Users/$USER/MyChromeDevUserData79
   ```

   `/Applications/Google\ Chrome79.app/` : **ç¨‹åºç›®å½•ï¼Œæ ¹æ®å®é™…ä¿®æ”¹ï¼Œæ­¤å¤„ `\ `ä¸ºè½¬ä¹‰å­—ç¬¦**ã€‚

   `--disable-web-security` : è®¾ç½®è·¨åŸŸï¼Œå¯ä¸åŠ ï¼›

   `--user-data-dir` ï¼š**79ç‰ˆæœ¬Chromeæ•°æ®å­˜å‚¨çš„ç›®å½•ï¼Œæ ¹æ®å®é™…ä¿®æ”¹**ã€‚

   ![](2.assets/7.jpeg)

6. ä¸‹æ¬¡é‡å¯ï¼ŒåŒæ ·éœ€è¦é€šè¿‡å‘½ä»¤å¯åŠ¨Chromeï¼›ä¸ºæ–¹ä¾¿ä»¥åæ‰“å¼€ï¼Œå¯ä»¥å°†å‘½ä»¤è½¬ä¸ºç¨‹åº

   æ‰“å¼€åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€ â€è‡ªåŠ¨æ“ä½œâ€œ ç¨‹åºï¼Œ

   ![](2.assets/8-7-1.jpeg)

   é€‰æ‹©â€œåº”ç”¨ç¨‹åºâ€ï¼Œ
   ![](2.assets/8-7-2.jpeg)
   
   æœç´¢ â€œè„šæœ¬â€ï¼Œé€‰æ‹© â€œè¿è¡ŒShellè„šæœ¬â€ï¼Œå°†å‘½ä»¤å¤åˆ¶è¾“å…¥æ¡†ï¼Œ
   
   ![](2.assets/8-7-3.jpeg)
   
   ä¿å­˜ä¸º `GoogleChrome79.app` (æ ¹æ®éœ€è¦ä¿®æ”¹)ï¼Œä¿å­˜ç›®å½•ä¸ºåº”ç”¨ç¨‹åºï¼Œ
   
   ![](2.assets/8-7-4.jpeg)
   
   æ‰“å¼€åº”ç”¨ç¨‹åºï¼Œå°±èƒ½æ‰¾åˆ° `GoogleChrome79.app`
   
   ![](2.assets/8-7-5.jpeg)
   
7. Chromeæµè§ˆå™¨é»˜è®¤è‡ªåŠ¨æ›´æ–°ï¼Œä¸‹æ¬¡é‡å¯å¯èƒ½ä¼šæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦å±è”½Chromeæµè§ˆå™¨è‡ªåŠ¨æ›´æ–°ï¼ˆå‚è€ƒ[æ–‡ç« ](https://juejin.cn/post/6979449894385745951)ï¼‰

   ç¼–è¾‘ hosts æ–‡ä»¶ï¼Œå±è”½Chromeæ›´æ–°è¯·æ±‚
   
   ```
   127.0.0.1 update.googleapis.com
   127.0.0.1 tools.google.com
   ```
   
   > macçš„hostsæ–‡ä»¶ç›®å½•: /private/etc/hosts ã€è¿›å…¥è®¿è¾¾ï¼ŒShift-Command-G æ‰“å¼€â€œå‰å¾€æ–‡ä»¶å¤¹â€ï¼Œè¾“å…¥/private/etcï¼Œæ‰¾åˆ°hostsæ–‡ä»¶
